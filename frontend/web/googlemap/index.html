<!DOCTYPE html>
<html>
  <head>
    <title>Google Maps Search Box</title>
    <style>
      /* Set the height of the map */
      #map {
        height: 400px;
      }
    </style>
  </head>
  <body>
    
    <div style="margin-bottom: 20px;">
      <label>Type the Name/Address of the Company</label>
      <input id="search" type="text" placeholder="Search..." class="form-control">
    </div>
    <div style="display:none;">
      <label for="lat">Latitude:</label>
      <input id="lat" type="number" step="any">
      <label for="lng">Longitude:</label>
      <input id="lng" type="number" step="any">
      <button id="go" type="button">Go</button>
    </div>

    <div>
      <label>Company Name:</label>
      <input id="company_name" type="text" disabled>
    </div>
    <div>
      <label>Address:</label>
      <input id="address" type="text" disabled>
    </div>
    <div>
      <label>Latitude:</label>
      <input id="latitude" type="text" disabled>
    </div>
    <div>
      <label>Longitude:</label>
      <input id="longitude" type="text" disabled>
    </div>
    
    <div id="map"></div>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAAyrQuYB1xJl7YohDMqATsOJWDI5vXprI&libraries=places,geometry&callback=initMap"
      async
      defer
    ></script>
    <script>
      let map;
      let marker;
      const cities = [
      {
        name: "Google Philippines",
        address: "11th Avenue, BGC, Taguig, Metro Manila",
        position: { lat: 14.5491, lng: 121.0496 },
      },
      {
        name: "Microsoft Philippines",
        address: "11th Floor 6750, Ayala Avenue, Makati, Metro Manila",
        position: { lat: 14.5562, lng: 121.0193 },
      },
      {
        name: "Amazon Philippines",
        address: "32nd Street, Taguig, Metro Manila",
        position: { lat: 14.5485, lng: 121.0462 },
      },
    ];
      const cityMarkers = [];

      function initMap() {
        map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: 14.6091, lng: 121.0223 }, // Center the map to Manila, Philippines
          zoom: 10,
        });

        const input = document.getElementById("search");
        const searchBox = new google.maps.places.SearchBox(input);

        map.addListener("bounds_changed", () => {
          searchBox.setBounds(map.getBounds());
        });

        searchBox.addListener("places_changed", () => {
          const places = searchBox.getPlaces();

          if (places.length == 0) {
            return;
          }

          const bounds = new google.maps.LatLngBounds();
          places.forEach((place) => {
            if (!place.geometry) {
              console.log("Returned place contains no geometry");
              return;
            }

            if (!marker) {
              marker = new google.maps.Marker({
                map,
                position: place.geometry.location,
              });
            } else {
              marker.setPosition(place.geometry.location);
            }

            if (place.geometry.viewport) {
              bounds.union(place.geometry.viewport);
            } else {
              bounds.extend(place.geometry.location);
            }

            // Fill the input fields with the selected company's information
            document.getElementById("company_name").value = place.name;
            document.getElementById("address").value = place.formatted_address;
            document.getElementById("latitude").value = place.geometry.location.lat();
            document.getElementById("longitude").value = place.geometry.location.lng();
          });

          map.fitBounds(bounds);
          map.setZoom(14);
        });

        searchBox.addListener("places_changed", () => {
          const places = searchBox.getPlaces();

          if (places.length == 0) {
            return;
          }

          const bounds = new google.maps.LatLngBounds();
          places.forEach((place) => {
            if (!place.geometry) {
              console.log("Returned place contains no geometry");
              return;
            }

            if (!marker) {
              marker = new google.maps.Marker({
                map,
                position: place.geometry.location,
              });
            } else {
              marker.setPosition(place.geometry.location);
            }

            if (place.geometry.viewport) {
              bounds.union(place.geometry.viewport);
            } else {
              bounds.extend(place.geometry.location);
            }

            // Fill the input fields with the selected company's information
            document.getElementById("company_name").value = place.name;
            document.getElementById("address").value = place.formatted_address;
            document.getElementById("latitude").value = place.geometry.location.lat();
            document.getElementById("longitude").value = place.geometry.location.lng();
          });

          map.fitBounds(bounds);
          map.setZoom(14);

          // Fill the address input field with the selected search value
          const searchValue = document.getElementById("search").value;
          document.getElementById("address").value = searchValue;
        });


        const goButton = document.getElementById("go");
        goButton.addEventListener("click", () => {
          const lat = parseFloat(document.getElementById("lat").value);
          const lng = parseFloat(document.getElementById("lng").value);

          if (isNaN(lat) || isNaN(lng)) {
            console.log("Invalid coordinates");
            return;
          }

          const location = new google.maps.LatLng(lat, lng);

          if (!marker) {
            marker = new google.maps.Marker({
              map,
              position: location,
            });
          } else {
            marker.setPosition(location);
          }

          map.setCenter(location);
          map.setZoom(14);

          console.log(marker.getPosition().lat());
          console.log(marker.getPosition().lng());
        });

        // Add markers for the cities
        // Add markers for the cities
      cities.forEach((city) => {
        const cityMarker = new google.maps.Marker({
          position: city.position,
          map,
          title: city.name,
        });

        const infoWindow = new google.maps.InfoWindow({
          content: `<h3>${city.name}</h3><p>${city.address}</p>`,
        });

        cityMarker.addListener("click", () => {
          infoWindow.open(map, cityMarker);
        });

        cityMarkers.push(cityMarker);
      });

      }
    </script>
  </body>
</html>

<!-- The updated code creates a single cities array that contains the name and position of each city. The array is then looped through using forEach(), and a marker is created for each city using the google.maps.Marker constructor. The markers are stored in the cityMarkers array for later use.

You can add or remove cities from the cities array as needed, and the markers will be created or removed automatically. -->
